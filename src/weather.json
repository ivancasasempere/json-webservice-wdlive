<?php header('content-type: application/json; charset=utf-8');

# Copyright 2015 Wayne D Grant (www.waynedgrant.com)
# Licensed under the MIT License

require_once("config.php");
require_once("common.php");
require_once("ClientRaw.php");

$clientRaw = new ClientRaw(CLIENT_RAW_DIRECTORY . "clientraw.txt");

$temperature_item = array(
    "current" => createTemperatureItem($clientRaw->getOutdoorTemperature()),
    "high" => createTemperatureItem($clientRaw->getDailyMaxOutdoorTemperature()),
    "low" => createTemperatureItem($clientRaw->getDailyMinOutdoorTemperature()),
    "trend" => $clientRaw->getOutdoorTemperatureTrend()->getTrend()
);

$data = array(
    "endpoint" => createEndpointItem(),
    "station" => createStationItem($clientRaw),
    "time" => createTimeItem($clientRaw),
    "temperature" => $temperature_item,
    "pressure" => array(),
    "rainfall" => array(),
    "wind" => array(),
    "humidity" => array(),
    "dew_point" => array(),
    "wind_chill" => array(),
    "humidex" => array(),
    "heat_index" => array(),
    "uv" => array());

$json = json_encode($data);

echo isset($_GET['callback']) ? "{$_GET['callback']}($json)" : $json;

?>
